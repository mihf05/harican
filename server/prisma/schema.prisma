// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  SEEKER
  POSTER
  ADMIN
}

model User {
  id          String   @id @default(cuid())
  email       String?  @unique
  phone       String?  @unique
  password    String?
  emailVerified Boolean @default(false)
  phoneVerified Boolean @default(false)
  fullName    String
  role        UserRole @default(SEEKER)
  educationLevel String?
  department  String?
  experienceLevel String? // Fresher, Junior, Mid
  preferredCareerTrack String?
  cvText      String?
  bio         String?
  profileImage String?
  isActive    Boolean  @default(true)
  lastLoginAt DateTime?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  skills      UserSkill[]
  verifications Verification[]
  postedJobs  Job[]
  careerRoadmaps CareerRoadmap[]
  jobApplications JobApplication[]

  @@map("users")
}



model Verification {
  id         String   @id @default(cuid())
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  userId     String?

  user User? @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([identifier, value])
  @@map("verifications")
}

model UserSkill {
  id       String @id @default(cuid())
  userId   String
  skillName String
  level    String? // Beginner, Intermediate, Advanced
  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, skillName])
  @@map("user_skills")
}

model Job {
  id          String   @id @default(cuid())
  title       String
  company     String
  location    String
  isRemote    Boolean  @default(false)
  jobType     String   // Internship, Part-time, Full-time, Freelance
  experienceLevel String // Fresher, Junior, Mid
  description String?
  requirements String[]
  skills      String[]
  salary      String?
  applicationUrl String?
  postedById  String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  isActive    Boolean  @default(true)

  postedBy User? @relation(fields: [postedById], references: [id], onDelete: SetNull)
  jobApplications JobApplication[]

  @@map("jobs")
}

enum ApplicationStatus {
  PENDING
  REVIEWED
  INTERVIEW_SCHEDULED
  ACCEPTED
  REJECTED
  HIRED
}

model JobApplication {
  id        String            @id @default(cuid())
  userId    String
  jobId     String
  status    ApplicationStatus @default(PENDING)
  appliedAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt
  interviewDate DateTime?
  interviewNotes String?
  rejectionReason String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  job  Job  @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@unique([userId, jobId])
  @@map("job_applications")
}

model LearningResource {
  id          String   @id @default(cuid())
  title       String
  platform    String   // YouTube, Coursera, Udemy, etc.
  url         String
  description String?
  skills      String[] // Related skills
  costType    String   // Free, Paid
  duration    String?  // e.g., "2 hours", "5 weeks"
  level       String?  // Beginner, Intermediate, Advanced
  rating      Float?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  isActive    Boolean  @default(true)

  @@map("learning_resources")
}

model CareerRoadmap {
  id              String   @id @default(cuid())
  userId          String
  targetRole      String   // Frontend Developer, Data Analyst, etc.
  timeframe       Int      // in months (3, 6, 12)
  learningTime    String?  // hours per week
  currentSkills   String[] // Skills user has now
  roadmapData     Json     // Structured roadmap with phases, topics, projects
  status          String   @default("active") // active, completed, archived
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("career_roadmaps")
}
